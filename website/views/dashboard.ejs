<%- include('partials/header') %>

<main class="main-content dashboard-page">
    <div class="dashboard-container">
        <div class="dashboard-sidebar">
            <div class="sidebar-user">
                <img src="https://cdn.discordapp.com/avatars/<%= user.id %>/<%= user.avatar %>.png" alt="Avatar">
                <div class="sidebar-user-info">
                    <h3><%= user.username %></h3>
                    <span>Dashboard</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="/dashboard" class="sidebar-link active">
                    <i class="fas fa-home"></i>
                    <span>Overview</span>
                </a>
                <a href="#servers" class="sidebar-link">
                    <i class="fas fa-server"></i>
                    <span>Servers</span>
                </a>
                <a href="/status" class="sidebar-link">
                    <i class="fas fa-heartbeat"></i>
                    <span>Status</span>
                </a>
            </nav>
        </div>

        <div class="dashboard-content">
            <div class="dashboard-header">
                <h1>Welcome, <%= user.username %>!</h1>
                <p>Select a server to manage</p>
            </div>

            <div class="servers-section" id="servers">
                <h2><i class="fas fa-server"></i> Your Servers</h2>
                <div class="servers-grid" id="servers-grid">
                    <% if (user.guilds) { %>
                        <% user.guilds.filter(g => (g.permissions & 0x20) === 0x20).forEach(guild => { %>
                            <div class="server-card">
                                <% if (guild.icon) { %>
                                    <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png" alt="<%= guild.name %>" class="server-icon">
                                <% } else { %>
                                    <div class="server-icon-placeholder">
                                        <%= guild.name.charAt(0) %>
                                    </div>
                                <% } %>
                                <div class="server-info">
                                    <h3><%= guild.name %></h3>
                                    <span class="server-id"><%= guild.id %></span>
                                </div>
                                <a href="/dashboard/server/<%= guild.id %>" class="btn btn-primary btn-sm">
                                    Manage <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        <% }) %>
                    <% } %>
                </div>
            </div>

            <div class="quick-stats">
                <h2><i class="fas fa-chart-bar"></i> Quick Stats</h2>
                <div class="stats-grid">
                    <div class="quick-stat-card">
                        <div class="stat-icon"><i class="fas fa-server"></i></div>
                        <div class="stat-content">
                            <h3 id="total-servers">0</h3>
                            <span>Your Servers</span>
                        </div>
                    </div>
                    <div class="quick-stat-card">
                        <div class="stat-icon"><i class="fas fa-crown"></i></div>
                        <div class="stat-content">
                            <h3 id="managed-servers">0</h3>
                            <span>Managed Servers</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const totalServers = document.querySelectorAll('.server-card').length;
    document.getElementById('total-servers').textContent = totalServers;
    document.getElementById('managed-servers').textContent = totalServers;
});
</script>

<%- include('partials/footer') %>
